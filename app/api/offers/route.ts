export const runtime="nodejs";import { readJSON, writeJSON } from "@/lib/fsdb";export async function POST(req:Request){const body=await req.json();const offers=await readJSON("offers.json",[] as any[]);const id="offer_"+(offers.length+1);const items=body?.items||[];const subtotal=items.reduce((s:any,it:any)=>s+it.price*it.qty*(1-((it.discount||0)/100)),0);const vatTotal=items.reduce((s:any,it:any)=>s+((it.vat||0)/100)*it.price*it.qty*(1-((it.discount||0)/100)),0);const total=Math.round((subtotal+vatTotal)*100)/100;const offer={id,...body,subtotal,vatTotal,total,status:"draft"};offers.push(offer);await writeJSON("offers.json",offers);return Response.json(offer);}